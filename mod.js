class t{constructor(t="",h=0,a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",c="cfhistuCFHISTU"){if(this.minLength=h,"number"!=typeof h)throw new TypeError(`Hashids: Provided 'minLength' has to be a number (is ${typeof h})`);if("string"!=typeof t)throw new TypeError(`Hashids: Provided 'salt' has to be a string (is ${typeof t})`);if("string"!=typeof a)throw new TypeError(`Hashids: Provided alphabet has to be a string (is ${typeof a})`);const p=Array.from(t),g=Array.from(a),u=Array.from(c);this.salt=p;const d=i(g);if(d.length<e)throw new Error(`Hashids: alphabet must contain at least ${e} unique characters, provided: ${d}`);this.alphabet=r(d,u);const b=o(u,d);let y,w;this.seps=l(b,p),(0===this.seps.length||this.alphabet.length/this.seps.length>s)&&(y=Math.ceil(this.alphabet.length/s),y>this.seps.length&&(w=y-this.seps.length,this.seps.push(...this.alphabet.slice(0,w)),this.alphabet=this.alphabet.slice(w))),this.alphabet=l(this.alphabet,p);const x=Math.ceil(this.alphabet.length/n);this.alphabet.length<3?(this.guards=this.seps.slice(0,x),this.seps=this.seps.slice(x)):(this.guards=this.alphabet.slice(0,x),this.alphabet=this.alphabet.slice(x)),this.guardsRegExp=f(this.guards),this.sepsRegExp=f(this.seps),this.allowedCharsRegExp=m([...this.alphabet,...this.guards,...this.seps])}encode(t,...e){return(e=Array.isArray(t)?t:[...null!=t?[t]:[],...e]).length?(e.every(h)||(e=e.map(t=>"bigint"==typeof t||"number"==typeof t?t:u(String(t)))),e.every(a)?this._encode(e).join(""):""):""}decode(t){return t&&"string"==typeof t&&0!==t.length?this._decode(t):[]}encodeHex(t){switch(typeof t){case"bigint":t=t.toString(16);break;case"string":if(!/^[0-9a-fA-F]+$/.test(t))return"";break;default:throw new Error(`Hashids: The provided value is neither a string, nor a BigInt (got: ${typeof t})`)}const e=d(t,12,t=>parseInt("1"+t,16));return this.encode(e)}decodeHex(t){return this.decode(t).map(t=>t.toString(16).slice(1)).join("")}_encode(t){let e=this.alphabet;const s=t.reduce((t,e,s)=>t+("bigint"==typeof e?Number(e%BigInt(s+100)):e%(s+100)),0);let n=[e[s%e.length]];const i=n.slice(),r=this.seps,o=this.guards;if(t.forEach((s,o)=>{const h=i.concat(this.salt,e);e=l(e,h);const a=c(s,e);if(n.push(...a),o+1<t.length){const t=a[0].codePointAt(0)+o,e="bigint"==typeof s?Number(s%BigInt(t)):s%t;n.push(r[e%r.length])}}),n.length<this.minLength){const t=(s+n[0].codePointAt(0))%o.length;if(n.unshift(o[t]),n.length<this.minLength){const t=(s+n[2].codePointAt(0))%o.length;n.push(o[t])}}const h=Math.floor(e.length/2);for(;n.length<this.minLength;){e=l(e,e),n.unshift(...e.slice(h)),n.push(...e.slice(0,h));const t=n.length-this.minLength;if(t>0){const e=t/2;n=n.slice(e,e+this.minLength)}}return n}isValidId(t){return this.allowedCharsRegExp.test(t)}_decode(t){if(!this.isValidId(t))throw new Error(`The provided ID (${t}) is invalid, as it contains characters that do not exist in the alphabet (${this.guards.join("")}${this.seps.join("")}${this.alphabet.join("")})`);const e=t.split(this.guardsRegExp),s=e[3===e.length||2===e.length?1:0];if(0===s.length)return[];const n=s[Symbol.iterator]().next().value,i=s.slice(n.length).split(this.sepsRegExp);let r=this.alphabet;const o=[];for(const t of i){const e=l(r,[n,...this.salt,...r].slice(0,r.length));o.push(p(Array.from(t),e)),r=e}return this._encode(o).join("")!==t?[]:o}}const e=16,s=3.5,n=12,i=t=>Array.from(new Set(t)),r=(t,e)=>t.filter(t=>!e.includes(t)),o=(t,e)=>t.filter(t=>e.includes(t)),h=t=>"bigint"==typeof t||!Number.isNaN(Number(t))&&Math.floor(Number(t))===t,a=t=>"bigint"==typeof t||t>=0&&Number.isSafeInteger(t);function l(t,e){if(0===e.length)return t;let s;const n=t.slice();for(let t=n.length-1,i=0,r=0;t>0;t--,i++){i%=e.length,r+=s=e[i].codePointAt(0);const o=(s+i+r)%t,h=n[t],a=n[o];n[o]=h,n[t]=a}return n}const c=(t,e)=>{const s=[];if("bigint"==typeof t){const n=BigInt(e.length);do{s.unshift(e[Number(t%n)]),t/=n}while(t>BigInt(0))}else do{s.unshift(e[t%e.length]),t=Math.floor(t/e.length)}while(t>0);return s},p=(t,e)=>t.reduce((s,n)=>{const i=e.indexOf(n);if(-1===i)throw new Error(`The provided ID (${t.join("")}) is invalid, as it contains characters that do not exist in the alphabet (${e.join("")})`);if("bigint"==typeof s)return s*BigInt(e.length)+BigInt(i);const r=s*e.length+i;if(Number.isSafeInteger(r))return r;if("function"==typeof BigInt)return BigInt(s)*BigInt(e.length)+BigInt(i);throw new Error("Unable to decode the provided string, due to lack of support for BigInt numbers in the current environment")},0),g=/^\+?[0-9]+$/,u=t=>g.test(t)?parseInt(t,10):NaN,d=(t,e,s)=>Array.from({length:Math.ceil(t.length/e)},(n,i)=>s(t.slice(i*e,(i+1)*e))),f=t=>new RegExp(t.map(t=>b(t)).sort((t,e)=>e.length-t.length).join("|")),m=t=>new RegExp(`^[${t.map(t=>b(t)).sort((t,e)=>e.length-t.length).join("")}]+$`),b=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),y=["/"],w=["\\","/"];class x{constructor(t,e){this.trailingSlash=!1,this.separators=e||function(){switch(Deno.build.os){case"linux":case"darwin":return["/"];case"windows":return["\\","/"];default:throw Error("unexpected platform")}}(),t?(this.trailingSlash="/"===t[0],this.pathElements=x.explodePath(this.separators,t)):this.pathElements=new Array}static explodePath(t,e){const s=e.split(""),n=new Array;let i="";for(let e=0;e<s.length;e++){let r=s[e];-1===t.indexOf(r)?i+=r:i&&(n.push(i),i="")}return n.push(i),n}toString(t,e){let s=this.pathElements.join(this.separators[0]);return e=e||"",s=(t=t||"").concat(s.concat(e)),this.trailingSlash?"/".concat(s):s}push(t){return x.explodePath(this.separatorList,t).forEach(t=>this.pathElements.push(t)),this}pop(){return this.pathElements.pop(),this}findLastValidNode(t){let e=this.toString();const s=new x(e);if(t)for(;!s.exists&&!s.isFile;)s.pop();else for(;!s.exists;)s.pop();return s}static diff(t,e){const s=t.elements,n=e.elements;return s.filter(t=>-1===n.indexOf(t))}get ext(){const t=this.pathElements[this.pathElements.length-1],e=t.split("").lastIndexOf(".");return 0!==e&&-1!==e?t.substr(e):null}get exists(){try{return Deno.statSync(this.toString()),!0}catch(t){if(t instanceof Deno.errors.PermissionDenied)throw t;return!1}}get isFile(){try{return Deno.statSync(this.toString()).isFile}catch(t){if(t instanceof Deno.errors.PermissionDenied)throw t;return!1}}get isDir(){try{return Deno.statSync(this.toString()).isDirectory}catch(t){if(t instanceof Deno.errors.PermissionDenied)throw t;return!1}}get isSymlink(){try{return Deno.statSync(this.toString()).isSymlink}catch(t){if(t instanceof Deno.errors.PermissionDenied)throw t;return!1}}get elements(){return this.pathElements}set elements(t){this.pathElements=t}set separatorList(t){this.separators=t}get separatorList(){return this.separators}static fromCWD(){return new x(Deno.cwd())}}function E(t,e){if(t.exists&&t.isDir)return!0;let s=t.findLastValidNode(),n=x.diff(t,s);for(let t=0;t<n.length;t++)s.push(n[t]),Deno.mkdirSync(s.toString());return!0}async function D(t,e){if(t.exists&&t.isDir)return!0;let s=t.findLastValidNode(),n=x.diff(t,s);for(let t=0;t<n.length;t++)s.push(n[t]),await Deno.mkdir(s.toString());return!0}function S(e=4096,s="",n="",i="."){const r=Math.floor(Math.random()*e),o=new t(r.toString(),10);let h;switch(s=s?s+i:"",n=n?i+n:"",Deno.build.os){case"windows":h=Deno.env.get("TMP")||Deno.env.get("TEMP");break;case"darwin":case"linux":h=Deno.env.get("TMPDIR")||"/tmp"}return new x(h).push(s+o.encode(r)+n)}export default x;export{y as LINUX_SEPS,x as Path,w as WINDOWS_SEPS,S as genTmpPath,D as mkDir,E as mkDirSync};
//# sourceMappingUrl=mod.js.map
